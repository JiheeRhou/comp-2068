<% 
    let action = "";
    let name = "";
    let description = "";
    let price = 0;
    let stock_quantity = 0;
    let productCategory = "";
    let method = "post";

    if (typeof product !== "undefined") {
        action = `/${product.id}`;
        name = product.name;
        description = product.description;
        price = product.price;
        stock_quantity = product.stock_quantity;
        productCategory = product.category;
        method = "put";
    }
 %>

<form action="/products<%= action %>" method="post" class="mt-3">
    <input type="hidden" name="_method" value="<%= method %>">

    <div class="mb-3">
        <label for="name" class="form-label">Name:</label>
        <input type="text" class="form-control" id="name" name="name" required value="<%= name %>">
    </div>

    <div class="mb-3">
        <label for="description" class="form-label">Description:</label>
        <input type="text" class="form-control" id="description" name="description" value="<%= description %>">
    </div>

    <div class="mb-3">
        <label for="price" class="form-label">Price:</label>
        <input type="number" class="form-control" id="price" name="price" required value="<%= price %>" step="0.01" min="0">
    </div>

    <div class="mb-3">
        <label for="stock_quantity" class="form-label">Stock Quantity:</label>
        <input type="number" class="form-control" id="stock_quantity" name="stock_quantity" required value="<%= stock_quantity %>" min="0">
    </div>

    <div class="mb-3">
        <label for="category" class="form-label">Category:</label>
        <select id="category" name="category" class="form-select" required>
            <option>Please select a category</option>
            <% productCategories.forEach(function(category) { %>
                <option value="<%= category %>" <%= category === productCategory ? "selected" : "" %>>
                    <%= category %>
                </option>
            <%}); %>    
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
</form>